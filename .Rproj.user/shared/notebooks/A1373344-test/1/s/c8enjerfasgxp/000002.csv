"0",""
"0","#read in parameter tables"
"0","#all_cause_mort <- data.table(read_excel(""../data/Ghana_hea_parameters.xlsx"", sheet = ""All_cause_mort""))"
"0","dt_transitions <- data.table(read_excel(""../data/Ghana_hea_parameters.xlsx"", sheet = ""Markov_probs""))"
"0","dt_microcost_params <- data.table(read_excel(""../data/Ghana_hea_parameters.xlsx"", sheet = ""Microcost_params""))"
"0","dt_riskmod_params <- data.table(read_excel(""../data/Ghana_hea_parameters.xlsx"", sheet = ""riskmod_params""))"
"0","dt_daly_params <- data.table(read_excel(""../data/Ghana_hea_parameters.xlsx"", sheet = ""daly_params""))"
"0",""
"0","#read in results"
"0","dt_bc_outcomes <- fread(""../results/BC_outcomes.csv"")"
"0","dt_bc_costs <- fread(""../results/BC_costs.csv"")"
"0","dt_bc_dalys <- fread(""../results/BC_dalys.csv"")"
"0","dt_PSA_microcost <- fread(""../results/PSA_microcost.csv"")"
"0","dt_PSA_params <- fread(""../results/PSA_params.csv"")"
"0","dt_psa_costs <- fread(""../results/PSA_costs.csv"")"
"0","dt_psa_dalys <- fread(""../results/PSA_dalys.csv"")"
"0","dt_psa_outcomes <- fread(""../results/PSA_outcomes.csv"")"
"0","dt_univ <- fread(""../results/univ_sens_analysis.csv"")"
"0",""
"0",""
"0","#Results table"
"0",""
"0","ae_abbrevs <- c(""sep"", ""mal"", ""ftr"", ""syp"", ""hbv"", ""hcv"", ""hiv"")"
"0",""
"0",""
"0","dt_bc_outcomes_count <- dt_bc_outcomes[ , lapply(.SD, comma)]"
"0","dt_bc_outcomes_dollar <- dt_bc_outcomes[ , lapply(.SD, dollar)]"
"0","dt_bc_outcomes_number <- dt_bc_outcomes[ , lapply(.SD, comma, accuracy = .01)]"
"0",""
"0",""
"0","dt_range_count <- dt_psa_outcomes[ , lapply(.SD, "
"0","                          function(x) "
"0","                          paste0(""("","
"0","                          comma(min(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "" – "","
"0","                          comma(max(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "")"")"
"0","                            )]"
"0",""
"0","dt_range_number <- dt_psa_outcomes[ , lapply(.SD, "
"0","                          function(x) "
"0","                          paste0(""("","
"0","                          comma(min(quantile(x, probs = c(0.025, 0.975))), "
"0","                                accuracy = .01),"
"0","                          "" – "","
"0","                          comma(max(quantile(x, probs = c(0.025, 0.975))),"
"0","                                accuracy = .01),"
"0","                          "")"")"
"0","                            )]"
"0",""
"0","dt_range_dollar <- dt_psa_outcomes[ , lapply(.SD, "
"0","                          function(x) "
"0","                          paste0(""("","
"0","                          dollar(min(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "" – "","
"0","                          dollar(max(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "")"")"
"0","                            )]"
"0","dt_range_np_costs <- dt_psa_costs[, lapply(.SD, "
"0","                              function(x) "
"0","                          paste0(""("","
"0","                          dollar(min(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "" – "","
"0","                          dollar(max(quantile(x, probs = c(0.025, 0.975)))),"
"0","                          "")"")), "
"0","                          .SDcols = ae_abbrevs]"
"0",""
"0","dt_range_np_dalys <- dt_psa_dalys[, lapply(.SD, "
"0","                              function(x) "
"0","                          paste0(""("","
"0","                          signif(min(quantile(x, probs = c(0.025, 0.975))),2),"
"0","                          "" – "","
"0","                          signif(max(quantile(x, probs = c(0.025, 0.975))),2),"
"0","                          "")""))]"
"0",""
"0",""
"0","outcomes_count <- c(""cases_no_prt"", ""cases_prt"", ""cases_reduced"")"
"0","outcomes_dollar <- c(""burden_no_prt"", ""burden_prt"", ""burden_reduced"")"
"0","outcomes_daly <- c(""DALY_no_prt"", ""DALY_prt"", ""DALY_reduced"")"
"0",""
"0",""
"0","results <- matrix("""", ncol = 8, nrow = 12, "
"0","                  dimnames = list(outcome = c(outcomes_count, "
"0","                                              ""cost_per_ae"","
"0","                                              ""YLD_per_ae"","
"0","                                              ""YLL_per_ae"","
"0","                                              outcomes_dollar,"
"0","                                              #""Total PI cost"","
"0","                                              #""Net savings of PI"","
"0","                                              outcomes_daly),"
"0","                                  ae = c(""all_ae"", ae_abbrevs)))"
"0",""
"0","for (outcome in outcomes_count){"
"0","  for (ae in c(""all_ae"", ae_abbrevs)){"
"0","    results[outcome, ae] <- paste0(dt_bc_outcomes_count[,get(paste0(ae,""."",outcome))], ""\n"", dt_range_count[,get(paste0(ae,""."",outcome))])"
"0","  }"
"0","}"
"0","for (outcome in outcomes_dollar){"
"0","  for (ae in c(""all_ae"", ae_abbrevs)){"
"0","    results[outcome, ae] <- paste0(dt_bc_outcomes_dollar[,get(paste0(ae,""."",outcome))], ""\n"", dt_range_dollar[,get(paste0(ae,""."",outcome))])"
"0","  }"
"0","}"
"0","for (ae in ae_abbrevs){"
"0","  results[""cost_per_ae"", ae] <- paste0(dt_bc_costs[,dollar(get(ae))], ""\n"", dt_range_np_costs[,get(ae)])"
"0","  results[""YLD_per_ae"", ae] <- paste0(dt_bc_dalys[,signif(get(paste0(""YLD."",ae)),2)], ""\n"", dt_range_np_dalys[,get(paste0(""YLD."",ae))])"
"0","  results[""YLL_per_ae"", ae] <- paste0(dt_bc_dalys[,signif(get(paste0(""YLL."",ae)),2)], ""\n"", dt_range_np_dalys[,get(paste0(""YLL."",ae))])"
"0","}"
"0",""
"0","# results[""Total PI cost"", ""all_ae""]<- paste0(dt_bc_outcomes_dollar[,prt_cost], ""\n"", dt_range_dollar[,prt_cost])"
"0","# results[""Net savings of PI"", ""all_ae""]<- paste0(dt_bc_outcomes_dollar[,net_savings], ""\n"", dt_range_dollar[,net_savings])"
"0","for (outcome in outcomes_daly){"
"0","  for (ae in c(""all_ae"", ae_abbrevs)){"
"0","    results[outcome, ae] <- paste0(dt_bc_outcomes_number[,get(paste0(ae,""."",outcome))], ""\n"", dt_range_number[,get(paste0(ae,""."",outcome))])"
"0","  }"
"0","}"
"0",""
"0",""
"0",""
"0","dt_results<-data.table(results, keep.rownames = TRUE)"
"0","colnames(dt_results) <- c(""Outcome"", ""All adverse events"", ""Sepsis"","
"0","                          ""Malaria"", ""FNHTR"", ""Syphilis"", ""HBV"","
"0","                          ""HCV"", ""HIV"")"
"0","outcome.names <- dt_results$Outcome"
"0","names(outcome.names) <- c(""Cases without WBPR"","
"0","                          ""Cases with WBPR"","
"0","                          ""Cases reduced by WBPR"","
"0","                          ""Net present cost per case"","
"0","                          ""YLD per case"","
"0","                          ""YLL per case"","
"0","                          ""Total net present cost without WBPR"","
"0","                          ""Total net present cost with WBPR"","
"0","                          ""Total net present cost reduced by WBPR"","
"0","                          ""DALYs without WBPR"","
"0","                          ""DALYs with WBPR"","
"0","                          ""DALYs averted by WBPR"")"
"0","dt_results[ , Outcome := names(outcome.names)[match(Outcome, outcome.names)] ]"
"0",""
"0","## Sensitivity analysis"
"0","#Secondary infections"
"0","dt_bc_outcomes[ , sec_infections_buden_reduced_all_ae := ("
"0","  sep.burden_reduced+mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    2*hiv.burden_reduced+2*hbv.burden_reduced+2*hcv.burden_reduced"
"0",")]"
"0","dt_psa_outcomes[ , sec_infections_buden_reduced_all_ae := ("
"0","  sep.burden_reduced+mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    2*hiv.burden_reduced+2*hbv.burden_reduced+2*hcv.burden_reduced"
"0",")]"
"0",""
"0",""
"0",""
"0","range_sec_case_burden_reduced <- paste(dt_psa_outcomes[ , dollar(quantile(sec_infections_buden_reduced_all_ae, probs=c(.025, .975)))], collapse = "" – "")"
"0",""
"0",""
"0","dt_bc_outcomes[ , sec_infections_buden_reduced_all_ae := ("
"0","  sep.burden_reduced+mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    2*hiv.burden_reduced+2*hbv.burden_reduced+2*hcv.burden_reduced"
"0",")]"
"0","dt_psa_outcomes[ , sec_infections_buden_reduced_all_ae := ("
"0","  sep.burden_reduced+mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    2*hiv.burden_reduced+2*hbv.burden_reduced+2*hcv.burden_reduced"
"0",")]"
"0","range_sec_case_burden_reduced <- paste(dt_psa_outcomes[ , dollar(quantile(sec_infections_buden_reduced_all_ae, probs=c(.025, .975)))], collapse = "" – "")"
"0",""
"0","#No sepsis"
"0","dt_bc_outcomes[ , no_sepsis_buden_reduced_all_ae := ("
"0","  mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    hiv.burden_reduced+hbv.burden_reduced+hcv.burden_reduced"
"0",")]"
"0","dt_psa_outcomes[ , no_sepsis_buden_reduced_all_ae := ("
"0","  mal.burden_reduced+ftr.burden_reduced+syp.burden_reduced+"
"0","    hiv.burden_reduced+hbv.burden_reduced+hcv.burden_reduced"
"0",")]"
"0","dt_bc_outcomes[ , no_sepsis_net_cost := ("
"0","  prt_cost - no_sepsis_buden_reduced_all_ae"
"0",")]"
"0","dt_psa_outcomes[ , no_sepsis_net_cost := ("
"0","   prt_cost - no_sepsis_buden_reduced_all_ae"
"0",")]"
"0","dt_bc_outcomes[ , no_sepsis_all_ae_DALY_reduced := ("
"0","  mal.DALY_reduced+ftr.DALY_reduced+syp.DALY_reduced+"
"0","    hiv.DALY_reduced+hbv.DALY_reduced+hcv.DALY_reduced"
"0",")]"
"0","dt_psa_outcomes[ , no_sepsis_all_ae_DALY_reduced := ("
"0","  mal.DALY_reduced+ftr.DALY_reduced+syp.DALY_reduced+"
"0","    hiv.DALY_reduced+hbv.DALY_reduced+hcv.DALY_reduced"
"0",")]"
"0","dt_bc_outcomes[ , no_sepsis_icer := (no_sepsis_net_cost)/no_sepsis_all_ae_DALY_reduced]"
"0","dt_psa_outcomes[ , no_sepsis_icer :=(no_sepsis_net_cost)/no_sepsis_all_ae_DALY_reduced]"
"0",""
"0",""
"0","range_no_sepsis_burden_reduced <- paste(dt_psa_outcomes[ , dollar(quantile(no_sepsis_buden_reduced_all_ae, probs=c(.025, .975)))], collapse = "" – "")"
"0","range_no_sepsis_net_cost <- paste(dt_psa_outcomes[ , dollar(quantile(no_sepsis_net_cost, probs=c(.025, .975)))], collapse = "" – "")"
"0","range_no_sepsis_DALY_reduced <- paste(dt_psa_outcomes[ , comma(quantile(no_sepsis_all_ae_DALY_reduced, probs=c(.025, .975)))], collapse = "" – "")"
"0","range_no_sepsis_icer <- paste(dt_psa_outcomes[ , dollar(quantile(no_sepsis_icer, probs=c(.025, .975)))], collapse = "" – "")"
"0",""
"0",""
